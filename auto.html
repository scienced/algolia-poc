<!doctype html>
<html lang="en">
  <head>
    <title>Algolia Search autocomplete - Colect POC</title>

    <script src="https://cdn.jsdelivr.net/npm/algoliasearch@4.14.2/dist/algoliasearch-lite.umd.js"></script>

    <script src="https://cdn.jsdelivr.net/npm/@algolia/autocomplete-js"></script>
<script>
  const { autocomplete, getAlgoliaResults } = window['@algolia/autocomplete-js'];
</script>
<script src="https://cdn.jsdelivr.net/npm/@algolia/autocomplete-plugin-query-suggestions"></script>
<script>
  const { createQuerySuggestionsPlugin } = window[
    '@algolia/autocomplete-plugin-query-suggestions'
  ];
</script>
<script src="https://cdn.jsdelivr.net/npm/@algolia/autocomplete-plugin-recent-searches"></script>
<script>
  const { createLocalStorageRecentSearchesPlugin } = window[
    '@algolia/autocomplete-plugin-recent-searches'
  ];
</script>



<link
  rel="stylesheet"
  href="https://cdn.jsdelivr.net/npm/@algolia/autocomplete-theme-classic"
/>

  </head>
  <body>
     <p>2. The search suggestions is based on the <strong>autocomplete.js</strong> library</p>
     <p><a href="index.html">See Instantsearch.js here</a></p>

      Pending features:
    <ul>
      <li>Search in categrories</li>
      <li>fix fixed suggestions</li>
    </ul>

     <h1>search</h1>

     <div id="autocomplete"></div>


     <script type="text/javascript">

      const searchClient = algoliasearch('E8HZJUFDQU', '2eab4588c570c21e4ef0e93c7483c45a');

      const querySuggestionsPlugin = createQuerySuggestionsPlugin({
        searchClient,
        indexName: 'PL_TriumphTEST_query_suggestions',
        getSearchParams({ state }) {
         return { hitsPerPage: state.query ? 5 : 5 };
        },
      });

      const recentSearchesPlugin = createLocalStorageRecentSearchesPlugin({
        key: 'RECENT_SEARCH',
        limit: 5,
      });
       
    autocomplete({
  container: '#autocomplete',
  placeholder: 'Search for products',
  plugins: [querySuggestionsPlugin, recentSearchesPlugin],
  openOnFocus: true,
  getSources({ query }) {
   
    if (!query) {
      return [
        {
          sourceId: 'links',
          getItems() {
            return [
              { label: 'Shipping information', url: 'https://www.apple.com/shop/shipping-pickup' },
              { label: 'Contact us', url: 'https://www.apple.com/contact/' },
            ];
          },
          getItemUrl({ item }) {
            return item.url;
          },
          templates: {
            item({ item }) {
              return item.label;
            },
          },
        },
      ];
    }

    return [
      {
        sourceId: 'products',
        getItems() {
          return getAlgoliaResults({
            searchClient,
            queries: [
              {
                indexName: 'PL_TriumphTEST',
                query,
                params: {
                  hitsPerPage: 5,
                  attributesToSnippet: ['name:10', 'description:35'],
                  snippetEllipsisText: 'â€¦',
                },
              },
            ],
          });
        },
        templates: {
          item({ item, components, html }) {
            return html`<div class="aa-ItemWrapper">
              <div class="aa-ItemContent">
                <div class="aa-ItemIcon aa-ItemIcon--alignTop">
                  <img
                    src="${item.image_link}"
                    alt="${item.name}"
                    width="40"
                    height="40"
                  />
                </div>
                <div class="aa-ItemContentBody">
                  <div class="aa-ItemContentTitle">
                    ${components.Highlight({
                      hit: item,
                      attribute: 'title',
                    })}
                  </div>
                 
                </div>
                <div class="aa-ItemActions">
                  <button
                    class="aa-ItemActionButton aa-DesktopOnly aa-ActiveOnly"
                    type="button"
                    title="Select"
                  >
                    <svg
                      viewBox="0 0 24 24"
                      width="20"
                      height="20"
                      fill="currentColor"
                    >
                      <path
                        d="M18.984 6.984h2.016v6h-15.188l3.609 3.609-1.406 1.406-6-6 6-6 1.406 1.406-3.609 3.609h13.172v-4.031z"
                      />
                    </svg>
                  </button>

                  
                </div>
              </div>
            </div>`;
          },
        },
      },
    ];
  },
   renderNoResults({ render, html, state }, root) {
    render(
      html`
        <div class="aa-PanelLayout aa-Panel--scrollable">
          No results for "${state.query}".
          lala
        </div>
      `,
      root
    )
  },
});

     </script>



  </body>

  </html>


